# Description:
#   Proxy: Next Generation Polymorphism in C++.

load("@rules_cc//cc:defs.bzl", "cc_library")

licenses(["notice"])  # Apache 2

exports_files(["LICENSE"])

SUPPORTED_CPP_STANDARDS = [
    "20",
    "23",
    "2b",
    "26",
]

[config_setting(
    name = "is_cpp" + v,
    values = {"cxxopt": "-std=c++" + v},
) for v in SUPPORTED_CPP_STANDARDS]

cc_library(
    name = "proxy",
    hdrs = glob(["include/**/*.h"]),
    strip_include_prefix = "include",
    target_compatible_with = select(
        {":is_cpp" + v: [] for v in SUPPORTED_CPP_STANDARDS} |
        {"//conditions:default": ["@platforms//:incompatible"]},
    ),
    visibility = ["//visibility:public"],
)
